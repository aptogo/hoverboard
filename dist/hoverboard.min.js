!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Hoverboard=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){!function(b,e){"object"==typeof d?c.exports=e():"function"==typeof a&&a.amd?a([],e):b.ensureArray=e()}(this,function(){"use strict";function a(a,b,c){if(0===arguments.length)return[];if(1===arguments.length){if(void 0===a||null===a)return[];if(Array.isArray(a))return a}return Array.prototype.slice.call(arguments)}return a})},{}],2:[function(a,b,c){"use strict";function d(a){var b;a&&a.length&&(b=a,a=b.length);var c=new Uint8Array(a||0);return b&&c.set(b),c.readUInt32LE=f.readUInt32LE,c.writeUInt32LE=f.writeUInt32LE,c.readInt32LE=f.readInt32LE,c.writeInt32LE=f.writeInt32LE,c.readFloatLE=f.readFloatLE,c.writeFloatLE=f.writeFloatLE,c.readDoubleLE=f.readDoubleLE,c.writeDoubleLE=f.writeDoubleLE,c.toString=f.toString,c.write=f.write,c.slice=f.slice,c.copy=f.copy,c._isBuffer=!0,c}function e(a){for(var b,c,d=a.length,e=[],f=0;d>f;f++){if(b=a.charCodeAt(f),b>55295&&57344>b){if(!c){b>56319||f+1===d?e.push(239,191,189):c=b;continue}if(56320>b){e.push(239,191,189),c=b;continue}b=c-55296<<10|b-56320|65536,c=null}else c&&(e.push(239,191,189),c=null);128>b?e.push(b):2048>b?e.push(b>>6|192,63&b|128):65536>b?e.push(b>>12|224,b>>6&63|128,63&b|128):e.push(b>>18|240,b>>12&63|128,b>>6&63|128,63&b|128)}return e}b.exports=d;var f,g,h,i=a("ieee754");f={readUInt32LE:function(a){return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},writeUInt32LE:function(a,b){this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24},readInt32LE:function(a){return(this[a]|this[a+1]<<8|this[a+2]<<16)+(this[a+3]<<24)},readFloatLE:function(a){return i.read(this,a,!0,23,4)},readDoubleLE:function(a){return i.read(this,a,!0,52,8)},writeFloatLE:function(a,b){return i.write(this,a,b,!0,23,4)},writeDoubleLE:function(a,b){return i.write(this,a,b,!0,52,8)},toString:function(a,b,c){var d="",e="";b=b||0,c=Math.min(this.length,c||this.length);for(var f=b;c>f;f++){var g=this[f];127>=g?(d+=decodeURIComponent(e)+String.fromCharCode(g),e=""):e+="%"+g.toString(16)}return d+=decodeURIComponent(e)},write:function(a,b){for(var c=a===g?h:e(a),d=0;d<c.length;d++)this[b+d]=c[d]},slice:function(a,b){return this.subarray(a,b)},copy:function(a,b){b=b||0;for(var c=0;c<this.length;c++)a[b+c]=this[c]}},f.writeInt32LE=f.writeUInt32LE,d.byteLength=function(a){return g=a,h=e(a),h.length},d.isBuffer=function(a){return!(!a||!a._isBuffer)}},{ieee754:4}],3:[function(a,b,c){(function(c){"use strict";function d(a){this.buf=n.isBuffer(a)?a:new n(a||0),this.pos=0,this.length=this.buf.length}function e(a,b){for(var c=0;c<a.length;c++)b.writeVarint(a[c])}function f(a,b){for(var c=0;c<a.length;c++)b.writeSVarint(a[c])}function g(a,b){for(var c=0;c<a.length;c++)b.writeFloat(a[c])}function h(a,b){for(var c=0;c<a.length;c++)b.writeDouble(a[c])}function i(a,b){for(var c=0;c<a.length;c++)b.writeBoolean(a[c])}function j(a,b){for(var c=0;c<a.length;c++)b.writeFixed32(a[c])}function k(a,b){for(var c=0;c<a.length;c++)b.writeSFixed32(a[c])}function l(a,b){for(var c=0;c<a.length;c++)b.writeFixed64(a[c])}function m(a,b){for(var c=0;c<a.length;c++)b.writeSFixed64(a[c])}b.exports=d;var n=c.Buffer||a("./buffer");d.Varint=0,d.Fixed64=1,d.Bytes=2,d.Fixed32=5;var o=4294967296,p=1/o,q=Math.pow(2,63);d.prototype={destroy:function(){this.buf=null},readFields:function(a,b,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),e=d>>3,f=this.pos;a(e,b,this),this.pos===f&&this.skip(d)}return b},readMessage:function(a,b){return this.readFields(a,b,this.readVarint()+this.pos)},readFixed32:function(){var a=this.buf.readUInt32LE(this.pos);return this.pos+=4,a},readSFixed32:function(){var a=this.buf.readInt32LE(this.pos);return this.pos+=4,a},readFixed64:function(){var a=this.buf.readUInt32LE(this.pos)+this.buf.readUInt32LE(this.pos+4)*o;return this.pos+=8,a},readSFixed64:function(){var a=this.buf.readUInt32LE(this.pos)+this.buf.readInt32LE(this.pos+4)*o;return this.pos+=8,a},readFloat:function(){var a=this.buf.readFloatLE(this.pos);return this.pos+=4,a},readDouble:function(){var a=this.buf.readDoubleLE(this.pos);return this.pos+=8,a},readVarint:function(){var a,b,c,d,e,f,g=this.buf;if(c=g[this.pos++],128>c)return c;if(c=127&c,d=g[this.pos++],128>d)return c|d<<7;if(d=(127&d)<<7,e=g[this.pos++],128>e)return c|d|e<<14;if(e=(127&e)<<14,f=g[this.pos++],128>f)return c|d|e|f<<21;if(a=c|d|e|(127&f)<<21,b=g[this.pos++],a+=268435456*(127&b),128>b)return a;if(b=g[this.pos++],a+=34359738368*(127&b),128>b)return a;if(b=g[this.pos++],a+=4398046511104*(127&b),128>b)return a;if(b=g[this.pos++],a+=562949953421312*(127&b),128>b)return a;if(b=g[this.pos++],a+=72057594037927940*(127&b),128>b)return a;if(b=g[this.pos++],a+=0x8000000000000000*(127&b),128>b)return a;throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){var a=this.pos,b=this.readVarint();if(q>b)return b;for(var c=this.pos-2;255===this.buf[c];)c--;a>c&&(c=a),b=0;for(var d=0;c-a+1>d;d++){var e=127&~this.buf[a+d];b+=4>d?e<<7*d:e*Math.pow(2,7*d)}return-b-1},readSVarint:function(){var a=this.readVarint();return a%2===1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,b=this.buf.toString("utf8",this.pos,a);return this.pos=a,b},readBytes:function(){var a=this.readVarint()+this.pos,b=this.buf.slice(this.pos,a);return this.pos=a,b},readPackedVarint:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readVarint());return b},readPackedSVarint:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readSVarint());return b},readPackedBoolean:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readBoolean());return b},readPackedFloat:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readFloat());return b},readPackedDouble:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readDouble());return b},readPackedFixed32:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readFixed32());return b},readPackedSFixed32:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readSFixed32());return b},readPackedFixed64:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readFixed64());return b},readPackedSFixed64:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readSFixed64());return b},skip:function(a){var b=7&a;if(b===d.Varint)for(;this.buf[this.pos++]>127;);else if(b===d.Bytes)this.pos=this.readVarint()+this.pos;else if(b===d.Fixed32)this.pos+=4;else{if(b!==d.Fixed64)throw new Error("Unimplemented type: "+b);this.pos+=8}},writeTag:function(a,b){this.writeVarint(a<<3|b)},realloc:function(a){for(var b=this.length||16;b<this.pos+a;)b*=2;if(b!==this.length){var c=new n(b);this.buf.copy(c),this.buf=c,this.length=b}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.slice(0,this.length)},writeFixed32:function(a){this.realloc(4),this.buf.writeUInt32LE(a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),this.buf.writeInt32LE(a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),this.buf.writeInt32LE(-1&a,this.pos),this.buf.writeUInt32LE(Math.floor(a*p),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),this.buf.writeInt32LE(-1&a,this.pos),this.buf.writeInt32LE(Math.floor(a*p),this.pos+4),this.pos+=8},writeVarint:function(a){if(a=+a,127>=a)this.realloc(1),this.buf[this.pos++]=a;else if(16383>=a)this.realloc(2),this.buf[this.pos++]=a>>>0&127|128,this.buf[this.pos++]=a>>>7&127;else if(2097151>=a)this.realloc(3),this.buf[this.pos++]=a>>>0&127|128,this.buf[this.pos++]=a>>>7&127|128,this.buf[this.pos++]=a>>>14&127;else if(268435455>=a)this.realloc(4),this.buf[this.pos++]=a>>>0&127|128,this.buf[this.pos++]=a>>>7&127|128,this.buf[this.pos++]=a>>>14&127|128,this.buf[this.pos++]=a>>>21&127;else{for(var b=this.pos;a>=128;)this.realloc(1),this.buf[this.pos++]=255&a|128,a/=128;if(this.realloc(1),this.buf[this.pos++]=0|a,this.pos-b>10)throw new Error("Given varint doesn't fit into 10 bytes")}},writeSVarint:function(a){this.writeVarint(0>a?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a);var b=n.byteLength(a);this.writeVarint(b),this.realloc(b),this.buf.write(a,this.pos),this.pos+=b},writeFloat:function(a){this.realloc(4),this.buf.writeFloatLE(a,this.pos),this.pos+=4},writeDouble:function(a){this.realloc(8),this.buf.writeDoubleLE(a,this.pos),this.pos+=8},writeBytes:function(a){var b=a.length;this.writeVarint(b),this.realloc(b);for(var c=0;b>c;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,b){this.pos++;var c=this.pos;a(b,this);var d=this.pos-c,e=127>=d?1:16383>=d?2:2097151>=d?3:268435455>=d?4:Math.ceil(Math.log(d)/(7*Math.LN2));if(e>1){this.realloc(e-1);for(var f=this.pos-1;f>=c;f--)this.buf[f+e-1]=this.buf[f]}this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,b,c){this.writeTag(a,d.Bytes),this.writeRawMessage(b,c)},writePackedVarint:function(a,b){this.writeMessage(a,e,b)},writePackedSVarint:function(a,b){this.writeMessage(a,f,b)},writePackedBoolean:function(a,b){this.writeMessage(a,i,b)},writePackedFloat:function(a,b){this.writeMessage(a,g,b)},writePackedDouble:function(a,b){this.writeMessage(a,h,b)},writePackedFixed32:function(a,b){this.writeMessage(a,j,b)},writePackedSFixed32:function(a,b){this.writeMessage(a,k,b)},writePackedFixed64:function(a,b){this.writeMessage(a,l,b)},writePackedSFixed64:function(a,b){this.writeMessage(a,m,b)},writeBytesField:function(a,b){this.writeTag(a,d.Bytes),this.writeBytes(b)},writeFixed32Field:function(a,b){this.writeTag(a,d.Fixed32),this.writeFixed32(b)},writeSFixed32Field:function(a,b){this.writeTag(a,d.Fixed32),this.writeSFixed32(b)},writeFixed64Field:function(a,b){this.writeTag(a,d.Fixed64),this.writeFixed64(b)},writeSFixed64Field:function(a,b){this.writeTag(a,d.Fixed64),this.writeSFixed64(b)},writeVarintField:function(a,b){this.writeTag(a,d.Varint),this.writeVarint(b)},writeSVarintField:function(a,b){this.writeTag(a,d.Varint),this.writeSVarint(b)},writeStringField:function(a,b){this.writeTag(a,d.Bytes),this.writeString(b)},writeFloatField:function(a,b){this.writeTag(a,d.Fixed32),this.writeFloat(b)},writeDoubleField:function(a,b){this.writeTag(a,d.Fixed64),this.writeDouble(b)},writeBooleanField:function(a,b){this.writeVarintField(a,Boolean(b))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./buffer":2}],4:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],5:[function(b,c,d){!function(){"use strict";function b(a,c){return this instanceof b?(this._maxEntries=Math.max(4,a||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),c&&this._initFormat(c),void this.clear()):new b(a,c)}function d(a,b){a.bbox=e(a,0,a.children.length,b)}function e(a,b,c,d){for(var e,h=f(),i=b;c>i;i++)e=a.children[i],g(h,a.leaf?d(e):e.bbox);return h}function f(){return[1/0,1/0,-(1/0),-(1/0)]}function g(a,b){return a[0]=Math.min(a[0],b[0]),a[1]=Math.min(a[1],b[1]),a[2]=Math.max(a[2],b[2]),a[3]=Math.max(a[3],b[3]),a}function h(a,b){return a.bbox[0]-b.bbox[0]}function i(a,b){return a.bbox[1]-b.bbox[1]}function j(a){return(a[2]-a[0])*(a[3]-a[1])}function k(a){return a[2]-a[0]+(a[3]-a[1])}function l(a,b){return(Math.max(b[2],a[2])-Math.min(b[0],a[0]))*(Math.max(b[3],a[3])-Math.min(b[1],a[1]))}function m(a,b){var c=Math.max(a[0],b[0]),d=Math.max(a[1],b[1]),e=Math.min(a[2],b[2]),f=Math.min(a[3],b[3]);return Math.max(0,e-c)*Math.max(0,f-d)}function n(a,b){return a[0]<=b[0]&&a[1]<=b[1]&&b[2]<=a[2]&&b[3]<=a[3]}function o(a,b){return b[0]<=a[2]&&b[1]<=a[3]&&b[2]>=a[0]&&b[3]>=a[1]}function p(a,b,c,d,e){for(var f,g=[b,c];g.length;)c=g.pop(),b=g.pop(),d>=c-b||(f=b+Math.ceil((c-b)/d/2)*d,q(a,b,c,f,e),g.push(b,f,f,c))}function q(a,b,c,d,e){for(var f,g,h,i,j,k,l,m,n;c>b;){for(c-b>600&&(f=c-b+1,g=d-b+1,h=Math.log(f),i=.5*Math.exp(2*h/3),j=.5*Math.sqrt(h*i*(f-i)/f)*(0>g-f/2?-1:1),k=Math.max(b,Math.floor(d-g*i/f+j)),l=Math.min(c,Math.floor(d+(f-g)*i/f+j)),q(a,k,l,d,e)),m=a[d],g=b,n=c,r(a,b,d),e(a[c],m)>0&&r(a,b,c);n>g;){for(r(a,g,n),g++,n--;e(a[g],m)<0;)g++;for(;e(a[n],m)>0;)n--}0===e(a[b],m)?r(a,b,n):(n++,r(a,n,c)),d>=n&&(b=n+1),n>=d&&(c=n-1)}}function r(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}b.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],d=this.toBBox;if(!o(a,b.bbox))return c;for(var e,f,g,h,i=[];b;){for(e=0,f=b.children.length;f>e;e++)g=b.children[e],h=b.leaf?d(g):g.bbox,o(a,h)&&(b.leaf?c.push(g):n(a,h)?this._all(g,c):i.push(g));b=i.pop()}return c},collides:function(a){var b=this.data,c=this.toBBox;if(!o(a,b.bbox))return!1;for(var d,e,f,g,h=[];b;){for(d=0,e=b.children.length;e>d;d++)if(f=b.children[d],g=b.leaf?c(f):f.bbox,o(a,g)){if(b.leaf||n(a,g))return!0;h.push(f)}b=h.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;c>b;b++)this.insert(a[b]);return this}var d=this._build(a.slice(),0,a.length-1,0);if(this.data.children.length)if(this.data.height===d.height)this._splitRoot(this.data,d);else{if(this.data.height<d.height){var e=this.data;this.data=d,d=e}this._insert(d,this.data.height-d.height-1,!0)}else this.data=d;return this},insert:function(a){return a&&this._insert(a,this.data.height-1),this},clear:function(){return this.data={children:[],height:1,bbox:f(),leaf:!0},this},remove:function(a){if(!a)return this;for(var b,c,d,e,f=this.data,g=this.toBBox(a),h=[],i=[];f||h.length;){if(f||(f=h.pop(),c=h[h.length-1],b=i.pop(),e=!0),f.leaf&&(d=f.children.indexOf(a),-1!==d))return f.children.splice(d,1),h.push(f),this._condense(h),this;e||f.leaf||!n(f.bbox,g)?c?(b++,f=c.children[b],e=!1):f=null:(h.push(f),i.push(b),b=0,c=f,f=f.children[0])}return this},toBBox:function(a){return a},compareMinX:function(a,b){return a[0]-b[0]},compareMinY:function(a,b){return a[1]-b[1]},toJSON:function(){return this.data},fromJSON:function(a){return this.data=a,this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,e){var f,g=c-b+1,h=this._maxEntries;if(h>=g)return f={children:a.slice(b,c+1),height:1,bbox:null,leaf:!0},d(f,this.toBBox),f;e||(e=Math.ceil(Math.log(g)/Math.log(h)),h=Math.ceil(g/Math.pow(h,e-1))),f={children:[],height:e,bbox:null,leaf:!1};var i,j,k,l,m=Math.ceil(g/h),n=m*Math.ceil(Math.sqrt(h));for(p(a,b,c,n,this.compareMinX),i=b;c>=i;i+=n)for(k=Math.min(i+n-1,c),p(a,i,k,m,this.compareMinY),j=i;k>=j;j+=m)l=Math.min(j+m-1,k),f.children.push(this._build(a,j,l,e-1));return d(f,this.toBBox),f},_chooseSubtree:function(a,b,c,d){for(var e,f,g,h,i,k,m,n;;){if(d.push(b),b.leaf||d.length-1===c)break;for(m=n=1/0,e=0,f=b.children.length;f>e;e++)g=b.children[e],i=j(g.bbox),k=l(a,g.bbox)-i,n>k?(n=k,m=m>i?i:m,h=g):k===n&&m>i&&(m=i,h=g);b=h}return b},_insert:function(a,b,c){var d=this.toBBox,e=c?a.bbox:d(a),f=[],h=this._chooseSubtree(e,this.data,b,f);for(h.children.push(a),g(h.bbox,e);b>=0&&f[b].children.length>this._maxEntries;)this._split(f,b),b--;this._adjustParentBBoxes(e,f,b)},_split:function(a,b){var c=a[b],e=c.children.length,f=this._minEntries;this._chooseSplitAxis(c,f,e);var g=this._chooseSplitIndex(c,f,e),h={children:c.children.splice(g,c.children.length-g),height:c.height,bbox:null,leaf:!1};c.leaf&&(h.leaf=!0),d(c,this.toBBox),d(h,this.toBBox),b?a[b-1].children.push(h):this._splitRoot(c,h)},_splitRoot:function(a,b){this.data={children:[a,b],height:a.height+1,bbox:null,leaf:!1},d(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var d,f,g,h,i,k,l,n;for(k=l=1/0,d=b;c-b>=d;d++)f=e(a,0,d,this.toBBox),g=e(a,d,c,this.toBBox),h=m(f,g),i=j(f)+j(g),k>h?(k=h,n=d,l=l>i?i:l):h===k&&l>i&&(l=i,n=d);return n},_chooseSplitAxis:function(a,b,c){var d=a.leaf?this.compareMinX:h,e=a.leaf?this.compareMinY:i,f=this._allDistMargin(a,b,c,d),g=this._allDistMargin(a,b,c,e);g>f&&a.children.sort(d)},_allDistMargin:function(a,b,c,d){a.children.sort(d);var f,h,i=this.toBBox,j=e(a,0,b,i),l=e(a,c-b,c,i),m=k(j)+k(l);for(f=b;c-b>f;f++)h=a.children[f],g(j,a.leaf?i(h):h.bbox),m+=k(j);for(f=c-b-1;f>=b;f--)h=a.children[f],g(l,a.leaf?i(h):h.bbox),m+=k(l);return m},_adjustParentBBoxes:function(a,b,c){for(var d=c;d>=0;d--)g(b[d].bbox,a)},_condense:function(a){for(var b,c=a.length-1;c>=0;c--)0===a[c].children.length?c>0?(b=a[c-1].children,b.splice(b.indexOf(a[c]),1)):this.clear():d(a[c],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0])),this.compareMinY=new Function("a","b",b.join(a[1])),this.toBBox=new Function("a","return [a"+a.join(", a")+"];")}},"function"==typeof a&&a.amd?a("rbush",function(){return b}):"undefined"!=typeof c?c.exports=b:"undefined"!=typeof self?self.rbush=b:window.rbush=b}()},{}],6:[function(b,c,d){!function(){function b(a,b){function c(b){var c,d=a.arcs[0>b?~b:b],e=d[0];return a.transform?(c=[0,0],d.forEach(function(a){c[0]+=a[0],c[1]+=a[1]})):c=d[d.length-1],0>b?[c,e]:[e,c]}function d(a,b){for(var c in a){var d=a[c];delete b[d.start],delete d.start,delete d.end,d.forEach(function(a){e[0>a?~a:a]=1}),h.push(d)}}var e={},f={},g={},h=[],i=-1;return b.forEach(function(c,d){var e,f=a.arcs[0>c?~c:c];f.length<3&&!f[1][0]&&!f[1][1]&&(e=b[++i],b[i]=c,b[d]=e)}),b.forEach(function(a){var b,d,e=c(a),h=e[0],i=e[1];if(b=g[h])if(delete g[b.end],b.push(a),b.end=i,d=f[i]){delete f[d.start];var j=d===b?b:b.concat(d);f[j.start=b.start]=g[j.end=d.end]=j}else f[b.start]=g[b.end]=b;else if(b=f[i])if(delete f[b.start],b.unshift(a),b.start=h,d=g[h]){delete g[d.end];var k=d===b?b:d.concat(b);f[k.start=d.start]=g[k.end=b.end]=k}else f[b.start]=g[b.end]=b;else b=[a],f[b.start=h]=g[b.end=i]=b}),d(g,f),d(f,g),b.forEach(function(a){e[0>a?~a:a]||h.push([a])}),h}function d(a,c,d){function e(a){var b=0>a?~a:a;(k[b]||(k[b]=[])).push({i:a,g:j})}function f(a){a.forEach(e)}function g(a){a.forEach(f)}function h(a){"GeometryCollection"===a.type?a.geometries.forEach(h):a.type in l&&(j=a,l[a.type](a.arcs))}var i=[];if(arguments.length>1){var j,k=[],l={LineString:f,MultiLineString:g,Polygon:g,MultiPolygon:function(a){a.forEach(g)}};h(c),k.forEach(arguments.length<3?function(a){i.push(a[0].i)}:function(a){d(a[0].g,a[a.length-1].g)&&i.push(a[0].i)})}else for(var m=0,n=a.arcs.length;n>m;++m)i.push(m);return{type:"MultiLineString",arcs:b(a,i)}}function e(a,c){function d(a){a.forEach(function(b){b.forEach(function(b){(f[b=0>b?~b:b]||(f[b]=[])).push(a)})}),g.push(a)}function e(b){return m(h(a,{type:"Polygon",arcs:[b]}).coordinates[0])>0}var f={},g=[],i=[];return c.forEach(function(a){"Polygon"===a.type?d(a.arcs):"MultiPolygon"===a.type&&a.arcs.forEach(d)}),g.forEach(function(a){if(!a._){var b=[],c=[a];for(a._=1,i.push(b);a=c.pop();)b.push(a),a.forEach(function(a){a.forEach(function(a){f[0>a?~a:a].forEach(function(a){a._||(a._=1,c.push(a))})})})}}),g.forEach(function(a){delete a._}),{type:"MultiPolygon",arcs:i.map(function(c){var d,g=[];if(c.forEach(function(a){a.forEach(function(a){a.forEach(function(a){f[0>a?~a:a].length<2&&g.push(a)})})}),g=b(a,g),(d=g.length)>1)for(var h,i=e(c[0][0]),j=0;d>j;++j)if(i===e(g[j])){h=g[0],g[0]=g[j],g[j]=h;break}return g})}}function f(a,b){return"GeometryCollection"===b.type?{type:"FeatureCollection",features:b.geometries.map(function(b){return g(a,b)})}:g(a,b)}function g(a,b){var c={type:"Feature",id:b.id,properties:b.properties||{},geometry:h(a,b)};return null==b.id&&delete c.id,c}function h(a,b){function c(a,b){b.length&&b.pop();for(var c,d=k[0>a?~a:a],e=0,f=d.length;f>e;++e)b.push(c=d[e].slice()),j(c,e);0>a&&i(b,f)}function d(a){return a=a.slice(),j(a,0),a}function e(a){for(var b=[],d=0,e=a.length;e>d;++d)c(a[d],b);return b.length<2&&b.push(b[0].slice()),b}function f(a){for(var b=e(a);b.length<4;)b.push(b[0].slice());return b}function g(a){return a.map(f)}function h(a){var b=a.type;return"GeometryCollection"===b?{type:b,geometries:a.geometries.map(h)}:b in l?{type:b,coordinates:l[b](a)}:null}var j=q(a.transform),k=a.arcs,l={Point:function(a){return d(a.coordinates)},MultiPoint:function(a){return a.coordinates.map(d)},LineString:function(a){return e(a.arcs)},MultiLineString:function(a){return a.arcs.map(e)},Polygon:function(a){return g(a.arcs)},MultiPolygon:function(a){return a.arcs.map(g)}};return h(b)}function i(a,b){for(var c,d=a.length,e=d-b;e<--d;)c=a[e],a[e++]=a[d],a[d]=c}function j(a,b){for(var c=0,d=a.length;d>c;){var e=c+d>>>1;a[e]<b?c=e+1:d=e}return c}function k(a){function b(a,b){a.forEach(function(a){0>a&&(a=~a);var c=e[a];c?c.push(b):e[a]=[b]})}function c(a,c){a.forEach(function(a){b(a,c)})}function d(a,b){"GeometryCollection"===a.type?a.geometries.forEach(function(a){d(a,b)}):a.type in g&&g[a.type](a.arcs,b)}var e={},f=a.map(function(){return[]}),g={LineString:b,MultiLineString:c,Polygon:c,MultiPolygon:function(a,b){a.forEach(function(a){c(a,b)})}};a.forEach(d);for(var h in e)for(var i=e[h],k=i.length,l=0;k>l;++l)for(var m=l+1;k>m;++m){var n,o=i[l],p=i[m];(n=f[o])[h=j(n,p)]!==p&&n.splice(h,0,p),(n=f[p])[h=j(n,o)]!==o&&n.splice(h,0,o)}return f}function l(a,b){function c(a){f.remove(a),a[1][2]=b(a),f.push(a)}var d=q(a.transform),e=r(a.transform),f=p();return b||(b=n),a.arcs.forEach(function(a){for(var g,h,i=[],j=0,k=0,l=a.length;l>k;++k)h=a[k],d(a[k]=[h[0],h[1],1/0],k);for(var k=1,l=a.length-1;l>k;++k)g=a.slice(k-1,k+2),g[1][2]=b(g),i.push(g),f.push(g);for(var k=0,l=i.length;l>k;++k)g=i[k],g.previous=i[k-1],g.next=i[k+1];for(;g=f.pop();){var m=g.previous,n=g.next;g[1][2]<j?g[1][2]=j:j=g[1][2],m&&(m.next=n,m[2]=g[2],c(m)),n&&(n.previous=m,n[0]=g[0],c(n))}a.forEach(e)}),a}function m(a){for(var b,c=-1,d=a.length,e=a[d-1],f=0;++c<d;)b=e,e=a[c],f+=b[0]*e[1]-b[1]*e[0];return f/2}function n(a){var b=a[0],c=a[1],d=a[2];return Math.abs((b[0]-d[0])*(c[1]-b[1])-(b[0]-c[0])*(d[1]-b[1]))}function o(a,b){return a[1][2]-b[1][2]}function p(){function a(a,b){for(;b>0;){var c=(b+1>>1)-1,e=d[c];if(o(a,e)>=0)break;d[e._=b]=e,d[a._=b=c]=a}}function b(a,b){for(;;){var c=b+1<<1,f=c-1,g=b,h=d[g];if(e>f&&o(d[f],h)<0&&(h=d[g=f]),e>c&&o(d[c],h)<0&&(h=d[g=c]),g===b)break;d[h._=b]=h,d[a._=b=g]=a}}var c={},d=[],e=0;return c.push=function(b){return a(d[b._=e]=b,e++),e},c.pop=function(){if(!(0>=e)){var a,c=d[0];return--e>0&&(a=d[e],b(d[a._=0]=a,0)),c}},c.remove=function(c){var f,g=c._;if(d[g]===c)return g!==--e&&(f=d[e],(o(f,c)<0?a:b)(d[f._=g]=f,g)),g},c}function q(a){if(!a)return s;var b,c,d=a.scale[0],e=a.scale[1],f=a.translate[0],g=a.translate[1];return function(a,h){h||(b=c=0),a[0]=(b+=a[0])*d+f,a[1]=(c+=a[1])*e+g}}function r(a){if(!a)return s;var b,c,d=a.scale[0],e=a.scale[1],f=a.translate[0],g=a.translate[1];return function(a,h){h||(b=c=0);var i=(a[0]-f)/d|0,j=(a[1]-g)/e|0;a[0]=i-b,a[1]=j-c,b=i,c=j}}function s(){}var t={version:"1.6.20",mesh:function(a){return h(a,d.apply(this,arguments))},meshArcs:d,merge:function(a){return h(a,e.apply(this,arguments))},mergeArcs:e,feature:f,neighbors:k,presimplify:l};"function"==typeof a&&a.amd?a(t):"object"==typeof c&&c.exports?c.exports=t:this.topojson=t}()},{}],7:[function(a,b,c){b.exports.VectorTile=a("./lib/vectortile.js"),b.exports.VectorTileFeature=a("./lib/vectortilefeature.js"),b.exports.VectorTileLayer=a("./lib/vectortilelayer.js")},{"./lib/vectortile.js":8,"./lib/vectortilefeature.js":9,"./lib/vectortilelayer.js":10}],8:[function(a,b,c){"use strict";function d(a,b){for(this.layers={},this._buffer=a,b=b||a.length;a.pos<b;){var c=a.readVarint(),d=c>>3;if(3==d){var e=this.readLayer();e.length&&(this.layers[e.name]=e)}else a.skip(c)}}var e=a("./vectortilelayer");b.exports=d,d.prototype.readLayer=function(){var a=this._buffer,b=a.readVarint(),c=a.pos+b,d=new e(a,c);return a.pos=c,d},d.prototype.toGeoJSON=function(){for(var a={},b=Object.keys(this.layers),c=0;c<b.length;c++)a[b[c]]=this.layers[b[c]].toGeoJSON();return a}},{"./vectortilelayer":10}],9:[function(a,b,c){"use strict";function d(a,b,c,d,e){for(this.properties={},this.extent=c,this.type=0,this._buffer=a,this._geometry=-1,this._keys=d,b=b||a.length;a.pos<b;){var f=a.readVarint(),g=f>>3;if(1==g)this._id=a.readVarint();else if(2==g)for(var h=a.pos+a.readVarint();a.pos<h;){var i=d[a.readVarint()],j=e[a.readVarint()];this.properties[i]=j}else 3==g?this.type=a.readVarint():4==g?(this._geometry=a.pos,a.skip(f)):a.skip(f)}}var e=a("point-geometry");b.exports=d,d.types=["Unknown","Point","LineString","Polygon"],d.prototype.loadGeometry=function(){var a=this._buffer;a.pos=this._geometry;for(var b,c=a.readVarint(),d=a.pos+c,f=1,g=0,h=0,i=0,j=[];a.pos<d;){if(!g){var k=a.readVarint();f=7&k,g=k>>3}if(g--,1===f||2===f)h+=a.readSVarint(),i+=a.readSVarint(),1===f&&(b&&j.push(b),b=[]),b.push(new e(h,i));else{if(7!==f)throw new Error("unknown command "+f);b.push(b[0].clone())}}return b&&j.push(b),j},d.prototype.bbox=function(){var a=this._buffer;a.pos=this._geometry;for(var b=a.readVarint(),c=a.pos+b,d=1,e=0,f=0,g=0,h=1/0,i=-(1/0),j=1/0,k=-(1/0);a.pos<c;){if(!e){var l=a.readVarint();d=7&l,e=l>>3}if(e--,1===d||2===d)f+=a.readSVarint(),g+=a.readSVarint(),h>f&&(h=f),f>i&&(i=f),j>g&&(j=g),g>k&&(k=g);else if(7!==d)throw new Error("unknown command "+d)}return[h,j,i,k]},d.prototype.toGeoJSON=function(){for(var a={type:"Feature",geometry:{},properties:{}},b=0;b<this._keys.length;b++){var c=this._keys[b];a.properties[c]=this.properties[c]}a.geometry.coordinates=this.loadGeometry();for(var e=0;e<a.geometry.coordinates.length;e++)for(var f=a.geometry.coordinates[e],g=0;g<f.length;g++)f[g]=[f[g].x,f[g].y];return"Point"==d.types[this.type]?a.geometry.type="Point":"LineString"==d.types[this.type]?1==a.geometry.coordinates.length?(a.geometry.coordinates=a.geometry.coordinates[0],a.geometry.type="LineString"):a.geometry.type="MultiLineString":"Polygon"==d.types[this.type]&&(a.geometry.type="Polygon"),a}},{"point-geometry":11}],10:[function(a,b,c){"use strict";function d(a,b){this.version=1,this.name=null,this.extent=4096,this.length=0,this._buffer=a,this._keys=[],this._values=[],this._features=[];var c,d;for(b=b||a.length;a.pos<b;)c=a.readVarint(),d=c>>3,15===d?this.version=a.readVarint():1===d?this.name=a.readString():5===d?this.extent=a.readVarint():2===d?(this.length++,this._features.push(a.pos),a.skip(c)):3===d?this._keys.push(a.readString()):4===d?this._values.push(this.readFeatureValue()):a.skip(c)}var e=a("./vectortilefeature.js");b.exports=d,d.prototype.readFeatureValue=function(){for(var a,b,c=this._buffer,d=null,e=c.readVarint(),f=c.pos+e;c.pos<f;)if(a=c.readVarint(),b=a>>3,1==b)d=c.readString();else{if(2==b)throw new Error("read float");if(3==b)d=c.readDouble();else if(4==b)d=c.readVarint();else{if(5==b)throw new Error("read uint");6==b?d=c.readSVarint():7==b?d=Boolean(c.readVarint()):c.skip(a)}}return d},d.prototype.feature=function(a){if(0>a||a>=this._features.length)throw new Error("feature index out of bounds");this._buffer.pos=this._features[a];var b=this._buffer.readVarint()+this._buffer.pos;return new e(this._buffer,b,this.extent,this._keys,this._values)},d.prototype.toGeoJSON=function(){for(var a={type:"FeatureCollection",features:[]},b=0;b<this.length;b++)a.features.push(this.feature(b).toGeoJSON());return a}},{"./vectortilefeature.js":9}],11:[function(a,b,c){"use strict";function d(a,b){this.x=a,this.y=b}b.exports=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var b=a.x-this.x,c=a.y-this.y;return b*b+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,b){return Math.atan2(this.x*b-this.y*a,this.x*a+this.y*b)},_matMult:function(a){var b=a[0]*this.x+a[1]*this.y,c=a[2]*this.x+a[3]*this.y;return this.x=b,this.y=c,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=b*this.x-c*this.y,e=c*this.x+b*this.y;return this.x=d,this.y=e,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(a){return a instanceof d?a:Array.isArray(a)?new d(a[0],a[1]):a}},{}],12:[function(a,b,c){!function(a){var b=function(a){var b=a.backingStorePixelRatio||a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/b}(a),c=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c)},d={fillRect:"all",clearRect:"all",strokeRect:"all",moveTo:"all",lineTo:"all",arc:[0,1,2],arcTo:"all",bezierCurveTo:"all",isPointinPath:"all",isPointinStroke:"all",quadraticCurveTo:"all",rect:"all",translate:"all",createRadialGradient:"all",createLinearGradient:"all"};1!==b&&(c(d,function(c,d){a[d]=function(a){return function(){var d,e,f=Array.prototype.slice.call(arguments);if("all"===c)f=f.map(function(a){return a*b});else if(Array.isArray(c))for(d=0,e=c.length;e>d;d++)f[c[d]]*=b;return a.apply(this,f)}}(a[d])}),a.stroke=function(a){return function(){this.lineWidth*=b,a.apply(this,arguments),this.lineWidth/=b}}(a.stroke),a.fillText=function(a){return function(){var c=Array.prototype.slice.call(arguments);c[1]*=b,c[2]*=b,this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(a,c,d){return c*b+d}),a.apply(this,c),this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(a,c,d){return c/b+d})}}(a.fillText),a.strokeText=function(a){return function(){var c=Array.prototype.slice.call(arguments);c[1]*=b,c[2]*=b,this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(a,c,d){return c*b+d}),a.apply(this,c),this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(a,c,d){
return c/b+d})}}(a.strokeText))}(CanvasRenderingContext2D.prototype)},{}],13:[function(a,b,c){!function(a){a.getContext=function(a){return function(b){var c,d,e=a.call(this,b);return this.polyfillApplied?e:("2d"===b&&(c=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,d=(window.devicePixelRatio||1)/c,d>1&&(this.style.height=this.height+"px",this.style.width=this.width+"px",this.width*=d,this.height*=d),this.polyfillApplied=!0),e)}}(a.getContext)}(HTMLCanvasElement.prototype)},{}],14:[function(a,b,c){"use strict";a("./HTMLCanvasPolyfill.js"),a("./CanvasRenderingContextPolyfill.js");var d=a("./renderingInterface"),e=a("topojson"),f=a("pbf"),g=a("vector-tile").VectorTile,h=a("vector-tile").VectorTileLayer,i=a("rbush"),j=a("ensure-array");h.prototype.toGeoJSON||(h.prototype.toGeoJSON=function(){for(var a={type:"FeatureCollection",features:[]},b=0;b<this.length;b++)a.features.push(this.feature(b).toGeoJSON());return a}),b.exports=L.TileLayer.Canvas.extend({options:{async:!0},initialize:function(a,b){var c=this;L.TileLayer.Canvas.prototype.initialize.call(this,b),this._tileCache={},this._features={},this._renderers=[],this.featureId=b.featureId||function(a){return a.properties.id},"undefined"==typeof Number.prototype.toRad&&(Number.prototype.toRad=function(){return this*Math.PI/180}),this.setUrl(a),this.on("tileunload",function(a){var b=a.tile._tilePoint.x+":"+a.tile._tilePoint.y,d=c._activeLayers(a.tile);d.forEach(function(d){for(var e=a.tile._layers[d],f=e.features.length-1;f>=0;f--){var g=e.features[f],h=c.featureId(g);c._features[h]&&(delete c._features[h].tiles[b],0===Object.keys(c._features[h].tiles).length&&delete c._features[h])}}),a.tile.abort&&a.tile.abort(),a.tile.abort=null})},onAdd:function(a){L.TileLayer.Canvas.prototype.onAdd.call(this,a),this.options.onclick&&"function"==typeof this.options.onclick&&(this.clickHandler=this.handleClick.bind(this),a.on("click",this.clickHandler)),this.options.onmousemove&&"function"==typeof this.options.onmousemove&&(this.mouseMoveHandler=this.handleMouseMove.bind(this),a.on("mousemove",this.mouseMoveHandler))},onRemove:function(a){L.TileLayer.Canvas.prototype.onRemove.call(this,a),this.clickHandler&&a.off("click",this.clickHandler),a.off("click",this.clickHandler),this.mouseMoveHandler&&a.off("mousemove",this.mouseMoveHandler)},handleClick:function(a){var b=this.featuresAt(a);this.options.onclick(a,b,this)},handleMouseMove:function(a){var b=this.featuresAt(a);this.options.onmousemove(a,b,this)},featuresAt:function(a){var b,c,d=this,e=(performance.now(),this._getTileKey(a.latlng,this._map.getZoom())),f=this._tiles[e],g=this._getPixelRatio(f);if(!f)return[];if(!f._layers)return[];var h=Object.keys(f._layers);f._spatialIndex||(f._spatialIndex=i(9),b=[],h.forEach(function(a){for(c=f._layers[a].features.length-1;c>=0;c--){var e=f._layers[a].features[c];e.layer=a;var g=turf.extent(e);g[0]=g[0]/d.layerExtents[e.layer]*f.width,g[1]=g[1]/d.layerExtents[e.layer]*f.height,g[2]=g[2]/d.layerExtents[e.layer]*f.width,g[3]=g[3]/d.layerExtents[e.layer]*f.height,g.push(e),b.push(g)}}),f._spatialIndex.load(b));var j=a.layerPoint.x-f._leaflet_pos.x,k=a.layerPoint.y-f._leaflet_pos.y;j*=g,k*=g,b=f._spatialIndex.search([j,k,j,k]);var l=[];for(c=b.length-1;c>=0;c--){var m=b[c][4],n=j/f.width*d.layerExtents[m.layer],o=k/f.height*d.layerExtents[m.layer],p=turf.point([n,o]);if("Polygon"===m.geometry.type||"MultiPolygon"===m.geometry.type)turf.inside(p,m)&&l.push(d._features[d.featureId(m)]);else if("LineString"===m.geometry.type){var q=this._getDistanceFromLine(p.geometry.coordinates,m.geometry.coordinates);q=q/d.layerExtents[m.layer]*f.width,5>q&&l.push(d._features[d.featureId(m)])}}return l},_getTileKey:function(a,b){var c=parseInt(Math.floor((a.lng+180)/360*(1<<b))),d=parseInt(Math.floor((1-Math.log(Math.tan(a.lat.toRad())+1/Math.cos(a.lat.toRad()))/Math.PI)/2*(1<<b)));return[c,d].join(":")},_getDistanceFromLine:function(a,b){var c=Number.POSITIVE_INFINITY;if(b&&b.length>1){a=L.point(a[0],a[1]);for(var d=0,e=b.length-1;e>d;d++){var f=this._projectPointOnLineSegment(a,b[d],b[d+1]);f.distance<=c&&(c=f.distance)}}return c},_projectPointOnLineSegment:function(a,b,c){b=L.point(b[0],b[1]),c=L.point(c[0],c[1]);var d=b.distanceTo(c);if(1>d)return{distance:a.distanceTo(b),coordinate:b};var e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/Math.pow(d,2);if(1e-7>e)return{distance:a.distanceTo(b),coordinate:b};if(e>.9999999)return{distance:a.distanceTo(c),coordinate:c};var f=L.point(b.x+e*(c.x-b.x),b.y+e*(c.y-b.y));return{distance:a.distanceTo(f),point:f}},projector:function(a,b,c){var d=Math.pow(2,a.z),e=40075016.68557849,f=e/d,g=a.x%d,h=a.y%d,i={top:e/2-(h+1)/d*e,left:-(e/2)+g/d*e};return i.bottom=i.top+f,i.right=i.left+f,d3.geo.transform({point:function(a,b){var d=L.CRS.EPSG3857.project({lat:b,lng:a});d.x=(d.x-i.left)/f,d.y=1-(d.y-i.top)/f,d.x*=c,d.y*=c,this.stream.point(d.x,d.y)}})},clippedProjector:function(a,b,c,d){var e=this.projector(a,b,c,d),f=d3.geo.clipExtent().extent([[-8,-8],[c+8,c+8]]);return{stream:function(a){return e.stream(f.stream(a))}}},_fetchTile:function(a,b){var c=this._url+"@@"+JSON.stringify(a);if("function"==typeof this._tileCache[c])return this._tileCache[c](b),function(){};var d=this,e=this.getTileUrl(a),f=[];return this.fetch(e,function(a,c){a||(c=d.parse(c),f.forEach(function(a){a(null,c)})),b(a,c)})},render:function(a,b){if("function"==typeof b)return this._renderers.push({layer:a,run:b}),this;var c=new d(this,a);return this._renderers.push({layer:a,run:c.run.bind(c)}),c},drawData:function(a,b,c,d){var e=a.getContext("2d"),f=a.width;e.clearRect(0,0,f,f);var g=this._getPixelRatio(a),h={};if(this._renderers.length){var i=this;this._renderers.forEach(function(a){c[a.layer]&&("undefined"==typeof h[a.layer]&&(h[a.layer]=d3.geo.path().projection(i.clippedProjector(b,a.layer,f,g)).context(e)),a.run(e,c[a.layer].features,b,function(b){"object"!=typeof b||Array.isArray(b)||(b=[b]),e.beginPath(),b.forEach(h[a.layer])}))}),d()}else d(new Error("No renderer specified!"))},drawTile:function(a,b,c){function d(){var c=(performance.now(),document.createElement("canvas"));c.width=f.options.tileSize,c.height=f.options.tileSize,f.drawData(c,b,a._layers,function(b){if(e&&window.cancelAnimationFrame(e),e=window.requestAnimationFrame(function(){a.getContext("2d").drawImage(c,0,0),f.tileDrawn(a)}),b)throw b})}if("undefined"==typeof this._url)return void this.tileDrawn(a);var e,f=(performance.now(),this);this._adjustTilePoint(b),a._layers?d():a.abort=this._fetchTile(b,function(c,e){if(c)throw f.tileDrawn(a),c;a._layers=f._filterLayers(e);var g=f._activeLayers(a),h=b.x+":"+b.y;g.forEach(function(b){for(var c=a._layers[b],d=c.features.length-1;d>=0;d--){var e=c.features[d],g=f.featureId(e);if(f._features[g])f._features[g].tiles[h]=!0;else{var i={};i[h]=!0,f._features[g]={id:g,properties:e.properties,tiles:i}}}}),d()})},redrawTile:function(a){var b=this._tiles[a];if(b){var c=(b.getContext("2d"),a.split(":"));this.drawTile(b,{x:c[0],y:c[1]},this._map.getZoom())}},redrawFeatures:function(a){a=j(a);var b,c=this,d={};a.forEach(function(a){var e=a&&c.featureId(a);if(c._features[e]){var f=c._features[e].tiles;for(b in f)d[b]=!0}});for(b in d)c.redrawTile(b)},_filterLayers:function(a){if(!this.options.layers)return a;var b={};return this.options.layers.forEach(function(c){b[c]=a[c]}),b},_activeLayers:function(a){if(!this.options.layers)return Object.keys(a._layers);var b=[];for(var c in a._layers)this.options.layers[c]&&b.push(c);return b},_getPixelRatio:function(a){var b=a.backingStorePixelRatio||a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/b}}),b.exports.json=b.exports.extend({fetch:function(a,b){var c=d3.json(a,function(a,c){b(a,c.response||c)});return c.abort.bind(c)}}),b.exports.geojson=b.exports.json.extend({parse:function(a){return{geojson:a}}}),b.exports.topojson=b.exports.json.extend({parse:function(a){var b={};for(var c in a.objects)b[c]=e.feature(a,a.objects[c]);return b}}),b.exports.mvt=b.exports.extend({fetch:function(a,b){var c=d3.xhr(a).responseType("arraybuffer").get(function(a,c){b(a,c.response||c)});return c.abort.bind(c)},parse:function(a){var b=new g(new f(new Uint8Array(a))),c={};"undefined"==typeof this.layerExtents&&(this.layerExtents={});for(var d in b.layers)this.layerExtents[d]=b.layers[d].extent,c[d]=b.layers[d].toGeoJSON();return c},projector:function(a,b,c,d){var e=this;return d3.geo.transform({point:function(a,f){a=a/e.layerExtents[b]*c,f=f/e.layerExtents[b]*c,a/=d,f/=d,this.stream.point(a,f)}})}})},{"./CanvasRenderingContextPolyfill.js":12,"./HTMLCanvasPolyfill.js":13,"./renderingInterface":15,"ensure-array":1,pbf:3,rbush:5,topojson:6,"vector-tile":7}],15:[function(a,b,c){var d=function(a,b){this.layer=a,this.layerName=b,this.instructions=[],this.whereConditions=[];var c=this;Object.keys(a.__proto__).forEach(function(b){c[b]=function(){return a[b].apply(a,arguments)}}),["render","data","mode","addTo"].forEach(function(b){c[b]=function(){return a[b].apply(a,arguments)}})};d.prototype.minZoom=function(a){return this.minZoom=a,this},d.prototype.maxZoom=function(a){return this.maxZoom=a,this},d.prototype.fill=function(a){return this.instructions.push({type:"fill",color:a}),this},d.prototype.stroke=function(a,b){return this.instructions.push({type:"stroke",width:a,color:b}),this},d.prototype.fillBy=function(a,b,c){return this.fill(function(d){return b[d.properties[a]]||c}),this},d.prototype.strokeBy=function(a,b,c){return this.stroke(function(d){return b[d.properties[a]]||c}),this},d.prototype._where=function(a){var b=a.field,c=a.value;if("undefined"==typeof c)if("string"==typeof b)this.where(function(a){return a.properties[b]?!0:!1},void 0,a.invert);else if("object"==typeof b)for(var d in b)this.where(d,b[d],a.invert);else{if("function"!=typeof b)throw new Error("with RenderingInterface.where(field, value) if value is undefined then field must be a string, object, or function!");if(a.invert){var e=b;b=function(){return!e.apply(null,arguments)}}this.whereConditions.push(b)}else if("string"==typeof c||"number"==typeof c)this.where(function(a){return a.properties[b]==c},void 0,a.invert);else{if("object"!=typeof c||!Array.isArray(c))throw new Error("RenderingInterface.where(field, value) cannot be called with field as type "+typeof b+" and value as type "+typeof c);this.where(function(a){return-1!=c.indexOf(a.properties[b])},void 0,a.invert)}return this},d.prototype.where=function(a,b,c){return this._where({field:a,value:b,invert:c})},d.prototype.whereNot=function(a,b){return this._where({field:a,value:b,invert:!0})},d.prototype.run=function(a,b,c,d){"number"==typeof this.minZoom&&c.z<this.minZoom||"number"==typeof this.maxZoom&&c.z>this.maxZoom||(this.whereConditions.forEach(function(a){b=b.filter(a)}),this.instructions.forEach(function(c){if("fill"==c.type)if("string"==typeof c.color)a.fillStyle=c.color,d(b),a.fill();else{if("function"!=typeof c.color)throw new Error("fill color must be string or function, is type "+typeof c.color);b.forEach(function(b){a.fillStyle=c.color(b),d(b),a.fill()})}else if("stroke"==c.type)if("number"==typeof c.width&&"string"==typeof c.color)a.lineWidth=c.width,a.strokeStyle=c.color,d(b),a.stroke();else{if("function"!=typeof c.width&&"function"!=typeof c.color)throw new Error("Expected stroke(number or function, string or function) or stroke(function), got stroke("+typeof c.width+", "+typeof c.color+")");b.forEach(function(b){var e="function"==typeof c.width?c.width(b):c.width,f="function"==typeof c.color?c.color(b):c.color;"undefined"==typeof c.color&&Array.isArray(e)&&(f=e[1],e=e[0]),a.lineWidth=e,a.strokeStyle=f,d(b),a.stroke()})}}))},b.exports=d},{}]},{},[14])(14)});